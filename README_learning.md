# 🤖 自己学習型ToTo〇くん v2.0

## 📋 概要

自己学習型ToTo〇くんは、過去の当選データから自動的に学習し、予測精度を継続的に向上させるAI予測システムです。

## 🚀 主な機能

### 🔁 1. 評価モジュール（evaluate.py）
- 予測結果と実際の当選数字を照合
- 各パターンの一致数を算出
- 評価結果をJSON/CSVで記録
- パフォーマンス推移の分析

### 🧠 2. 改善モジュール（learn.py）
- 過去の評価結果から特徴量の重みを自動調整
- 有効な特徴量の重みを強化
- 無効な特徴量の重みを削減
- 学習履歴の保存

### 🔄 3. ループ実行モジュール（main_loop.py）
- 全処理の自動化
- 特徴量抽出 → 予測 → 評価 → 学習の循環
- 進捗管理とログ記録
- システム状態の監視

## 📁 ファイル構成

```
totomaru/
├── features.py              # 特徴量計算（既存）
├── predict_adaptive.py      # 適応型予測システム（新規）
├── evaluate.py              # 評価モジュール（新規）
├── learn.py                 # 学習モジュール（新規）
├── main_loop.py             # メインループ（新規）
├── totomaru.csv             # 当選データ
├── weights.json             # 重み設定（自動生成）
├── evaluation_results.json  # 評価結果（自動生成）
├── learning_history.json    # 学習履歴（自動生成）
└── processed_dates.json     # 処理済み日付（自動生成）
```

## 🛠️ セットアップ

### 1. 必要なライブラリ
```bash
pip install pandas numpy scipy
```

### 2. データファイルの準備
- `totomaru.csv` に過去の当選データを格納
- フォーマット: `DrawDate,Number1,Number2,Number3,Number4,Number5,Number6`

## 🎯 使用方法

### 基本的な実行
```bash
python main_loop.py
```

### メニュー選択

1. **学習ループ実行（全未処理抽選）**
   - 未処理の全抽選データに対して学習を実行
   - 初回実行時は全データが対象

2. **学習ループ実行（指定回数）**
   - 指定した回数分の抽選データで学習
   - 大量データがある場合の段階的学習に使用

3. **次回抽選予測**
   - 現在の学習済みモデルで次回抽選を予測
   - 6パターンの予測結果を表示

4. **実際の結果を追加**
   - 新しい当選結果を手動で追加
   - 即座に学習処理を実行

5. **システム状態表示**
   - 現在の重み設定
   - パフォーマンス統計
   - 処理済みデータ数

## 📊 学習プロセス

### 1. 特徴量抽出
- 総出現回数、直近出現回数、未出間隔
- ホット・コールド数字、周期性分析
- 回帰トレンド、移動平均
- 分布パターン、隣接相関など

### 2. 予測生成
- 各数字のスコアを重み付きで計算
- 組み合わせスコアで最適化
- 6パターンの予測を生成

### 3. 評価実行
- 予測と実際の結果を照合
- 一致数を算出
- 各パターンの詳細分析

### 4. 学習・改善
- 特徴量の有効性を分析
- 重みを自動調整
- 学習履歴を保存

## 📈 パフォーマンス監視

### 評価指標
- **最高一致数**: 最も多く当たった予測パターンの一致数
- **平均一致数**: 全予測パターンの平均一致数
- **一致数分布**: 0-6個一致の分布状況

### 重み調整
- 有効な特徴量の重みを強化
- 無効な特徴量の重みを削減
- 学習率による段階的調整

## 🔧 カスタマイズ

### 学習率の調整
```python
# learn.py の __init__ メソッドで調整
self.learning_rate = 0.1  # デフォルト値
```

### 重みの初期設定
```python
# predict_adaptive.py の default_weights で調整
default_weights = {
    'total_appearances': 0.15,
    'recent_appearances': 0.20,
    # ... 他の特徴量
}
```

### 予測パターン数の変更
```python
# main_loop.py の predict_numbers で調整
predictions = self.predictor.predict_numbers(num_predictions=6)
```

## 📝 ログファイル

### evaluation_results.json
- 各抽選の評価結果
- 予測パターンごとの詳細
- 一致数分布

### learning_history.json
- 重み調整の履歴
- 特徴量の有効性推移
- 学習タイムスタンプ

### weights.json
- 現在の重み設定
- 学習による最適化結果

## 🎯 使用例

### 初回セットアップ
```bash
python main_loop.py
# メニューから「1」を選択して全データで学習
```

### 新しい結果の追加
```bash
python main_loop.py
# メニューから「4」を選択
# 抽選日: 2023-08-11
# 数字: 3,15,22,28,35,41
```

### 次回予測
```bash
python main_loop.py
# メニューから「3」を選択
```

## ⚠️ 注意事項

1. **データの整合性**: CSVファイルの形式を正確に保つ
2. **重みの安定性**: 急激な重み変更を避ける
3. **過学習の防止**: 定期的なパフォーマンス確認
4. **バックアップ**: 重要なファイルの定期バックアップ

## 🔮 今後の拡張予定

- より高度な機械学習アルゴリズムの導入
- リアルタイム予測機能
- Webインターフェースの追加
- モバイルアプリ対応

## 📞 サポート

問題や質問がある場合は、以下のファイルを確認してください：
- `evaluation_results.json`: 評価結果の詳細
- `learning_history.json`: 学習プロセスの履歴
- `weights.json`: 現在の重み設定

---

**🤖 自己学習型ToTo〇くん v2.0 - 継続的に進化するAI予測システム** 